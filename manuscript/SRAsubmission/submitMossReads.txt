## let's get the reads from the moss project onto SRA

## a sort-of recent example on how to do this is here, on the laptop:

## on laptop:
vim -M /home/daniel/Documents/analyses/graham/grass-endophyte-community/SRAsubmission/submitGrahamReads.txt

## on officeComp
vim -M /home/daniel/Documents/projects/grass-endophyte-community/SRAsubmission/submitGrahamReads.txt

## this was bioproject PRJNA1160472
## https://www.ncbi.nlm.nih.gov/bioproject/PRJNA1160472

## most basic question - what are we submitting?

## 1,2 - raw, passed reads from both sequencing runs
## 3 - finished nifH and 16s sequences 

## raw passing reads are where? 

## on the nanopore computer: 

cd /media/vol1/daniel/rawDataNanopore/NostocColonyPCRsRound2/OGZygodonHylocomiumHomalia/OGZygodonHylocomiumHomalia_baseCalled/duplexTrial/trimmed

## these have been demultiplexed. 
## the barcodes we need are:

barcode  9 16S Amblystegium 
barcode 10 16S Homalia
barcode 11 16S Zygodon
barcode 12 NifH OG Hylocomium
barcode 13 NifH OG Zygodon
barcode 14 NifH Homalia

## corresponding files are:

2ed2dc90-9ec6-43dc-b1a6-362b75c1ab18_SQK-RBK114-24_barcode09.fastq
2ed2dc90-9ec6-43dc-b1a6-362b75c1ab18_SQK-RBK114-24_barcode10.fastq
2ed2dc90-9ec6-43dc-b1a6-362b75c1ab18_SQK-RBK114-24_barcode11.fastq
2ed2dc90-9ec6-43dc-b1a6-362b75c1ab18_SQK-RBK114-24_barcode12.fastq
2ed2dc90-9ec6-43dc-b1a6-362b75c1ab18_SQK-RBK114-24_barcode13.fastq
2ed2dc90-9ec6-43dc-b1a6-362b75c1ab18_SQK-RBK114-24_barcode14.fastq

## get these on the laptop:

trimmedDemuxedReadDir=/media/vol1/daniel/rawDataNanopore/NostocColonyPCRsRound2/OGZygodonHylocomiumHomalia/OGZygodonHylocomiumHomalia_baseCalled/duplexTrial/trimmed
putHere=/home/daniel/Documents/projects/mossCyanobacteria/culturingCyanos/nanoporeNostoc16sAlignments/reads2upload2SRA
for i in ${trimmedDemuxedReadDir}/2ed2dc90-9ec6-43dc-b1a6-362b75c1ab18_SQK-RBK114-24_barcode{09..14}.fastq; do
  rsync -auv test@132.180.112.115:$i $putHere
done

## we also need OG hylocomium reads - these are here:

getFile=/media/vol1/daniel/nostoc/minionReadsNostoc/allNostoc2.fasta
putHere=/home/daniel/Documents/projects/mossCyanobacteria/culturingCyanos/nanoporeNostoc16sAlignments/reads2upload2SRA
rsync -auv test@132.180.112.115:$getFile $putHere

## let's rename these accordingly:

for i in *barcode??.fastq; do
  mv $i ${i##2ed2dc90-9ec6-43dc-b1a6-362b75c1ab18_}
done

mv allNostoc2.fasta 16S_Hylocomium.fastq
mv SQK-RBK114-24_barcode09.fastq SQK-RBK114-24_barcode09_16S_Amblystegium.fastq 
mv SQK-RBK114-24_barcode10.fastq SQK-RBK114-24_barcode10_16S_Homalia.fastq 
mv SQK-RBK114-24_barcode11.fastq SQK-RBK114-24_barcode11_16S_Zygodon.fastq 
mv SQK-RBK114-24_barcode12.fastq SQK-RBK114-24_barcode12_NifH_Hylocomium.fastq
mv SQK-RBK114-24_barcode13.fastq SQK-RBK114-24_barcode13_NifH_Zygodon.fastq
mv SQK-RBK114-24_barcode14.fastq SQK-RBK114-24_barcode14_NifH_Homalia.fastq

## moved these out of the github repo:
cd /home/daniel/Documents/projects/mossCyanobacteria/culturingCyanos/reads2upload2SRA

## zip them all:
gzip *

## okay, renamed. That's the easy part...

## get our credentials from the SRA site by requesting a new submission folder

ftp -i ftp-private.ncbi.nlm.nih.gov

open ftp-private.ncbi.nlm.nih.gov

subftp

CrasHeshyevVafivgud2

cd uploads/danchurchthomas_gmail.com_VxAdPqLf

#mkdir nostocRawReads

cd nostocRawReads

mput  *fastq.gz

## I think that succeeded. Now we need to send the metadata to NCBI...

## using the NCBI SRA submission page (log in first):
https://submit.ncbi.nlm.nih.gov/subs/sra/SUB15915318/

## there were three associated files before...sample sheet, metadata sheet, and project info sheet

## sample-sheet. Things have changed a bit. My old templates don't quite work. 
## We'll try using "Package MIMARKS: specimen, plant-associated; version 6.0"
## https://genomicsstandardsconsortium.github.io/mixs/term_list/

## this looks very similar but not exactly like the old sample sheet, as per:
vim -M /home/daniel/Documents/projects/grass-endophyte-community/SRAsubmission/sampleSheet.tsv

## these are the fields I'll use:
*sample_name - different for each, 
sample_title - needed?
bioproject_accession - no bioproject yet
*organism - Nostoc or Compactonostoc
*collection_date - varies 
*env_broad_scale - "temperate broadleaf forest biome" or "temperate coniferous forest biome"
*env_local_scale - "temperate deciduous broadleaf forest" or "temperate evergreen needleleaf forest" 
*env_medium - "understory" for hylocomium, "forest canopy" for others
*geo_loc_name - varies, table 1 
*host - "Hylocomium splendens", etc
*isol_growth_condt - give doi for the rippka paper with BG110: doi: 10.1099/00221287-111-1-1
*lat_lon - use table 1, is already in correct format.
biotic_relationship - "Symbiosis with host moss, possible mutualism"
elev -table 1
host_life_stage "gametophyte"
host_taxid - look up on NCBI

